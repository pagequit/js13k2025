var ae=e=>[[[[,0,,.1,.2,,,.8,,,,,,.1,,,.05,.5,.05],[,0,440,.2,.2,0,,,,,,,,.1,,,.01,.4,.05,1],[,0,130,.1,.2,0,,,.1,-1,,,.1,.1,,,.01,.57,.04],[,0,110,,.1,.3,,.9,-.2,-2,10,,,.1,,,,.9],[,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[2,0,4e3,,,.03,2,1.25,,,,,.02,6.8,-.3,,.5],[,0,84,,,,,.7,,,,.5,,6.7,1,.05],[.4,0,1e4,,,,,,,,,,.01,6.8,-.2],[,0,415.3,.02,.2,,3,,,,10,.1,,,-1,,.05,.3,.1]],[[[1,,9,,11,9,12,11,,12],[7,,1,,,,1,,,,],[3,,,,3,,,,3,,]],[[1,,9,,11,9,12,11,14,12,16,14,17,16,,12,,,],[7,,1,,,,1,,1,,1,,1,,1,,1,,],[3,,,,3,,,,3,,,,3,,,,3,,]],[[,,10,,,,10,12,12,10,10,12,12,,,10,12,,],[,,,,,7,,,3,,,7,7,3,7,,,,],[8,,,,,,,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,]],[[7,,1,,,,1,,,,1,,1,,]]],[3,0,0,1],e],[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[1,0],[0,0],[0,1],[1,0],[0,0],[0,1],[0,0],[0,0],[1,0],[0,0],[0,1],[1,0],[0,0],[0,1],[0,0],[0,0],[1,0],[0,0],[0,1],[1,0],[0,0],[0,1],[2,0],[0,0],[0,0],[2,0],[0,2],[0,0],[0,0],[0,0],[0,0],[0,0]]];var K=e=>{let t=(...l)=>{let n=e.x.createBufferSource(),i=e.x.createBuffer(l.length,l[0].length,e.r);return l.map((o,u)=>i.getChannelData(u).set(o)),n.buffer=i,n.connect(e.x.destination),n.start(),n},a=(l=1,n=.05,i=220,o=0,u=0,x=.1,w=0,P=1,c=0,y=0,d=0,S=0,m=0,v=0,C=0,z=0,p=0,M=1,k=0,X=0)=>{let h=2*Math.PI,Y=c*=500*h/e.r**2,q=(0<C?1:-1)*h/4,B=i*=(1+2*n*Math.random()-n)*h/e.r,I=[],f=0,F=0,s=0,b=1,J=0,Ae=0,A=0,G,D;for(o=99+e.r*o,k*=e.r,u*=e.r,x*=e.r,p*=e.r,y*=500*h/e.r**3,C*=h/e.r,d*=h/e.r,S*=e.r,m=e.r*m|0,D=o+k+u+x+p|0;s<D;I[s++]=A)++Ae%(100*z|0)||(A=w?1<w?2<w?3<w?Math.sin((f%h)**3):Math.max(Math.min(Math.tan(f),1),-1):1-(2*f/h%2+2)%2:1-4*Math.abs(Math.round(f/h)-f/h):Math.sin(f),A=(m?1-X+X*Math.sin(2*Math.PI*s/m):1)*(0<A?1:-1)*Math.abs(A)**P*l*e.v*(s<o?s/o:s<o+k?1-(s-o)/k*(1-M):s<o+k+u?M:s<D-p?(D-s-p)/x*M:0),A=p?A/2+(p>s?0:(s<D-p?1:(D-s)/p)*I[s-p|0]/2):A),G=(i+=c+=y)*Math.sin(F*C-q),f+=G-G*v*(1-1e9*(Math.sin(s)+1)%2),F+=G-G*v*(1-1e9*(Math.sin(s)**2+1)%2),b&&++b>S&&(i+=d,B+=d,b=0),!m||++J%m||(i=B,c=Y,b=b||1);return I};return[(...l)=>t(a(...l)),t,(l,n,i,o=125)=>{let u,x,w,P,c,y,d,S,m,v,C,z,p,M,k,X=0,h=[],Y=[],q=[],B=0,I=0,f=1,F={},s=e.r/o*60>>2;for(;f;B++)h=[f=S=C=p=0],i.map((b,J)=>{for(d=n[b][B]||[0,0,0],f|=!!n[b][B],k=p+(n[b][0].length-2-!S)*s,M=J==i.length-1,x=2,P=p;x<d.length+M;S=++x){for(c=d[x],m=x==d.length+M-1&&M||v!=(d[0]||0)|c|0,w=0;w<s&&S;w++>s-99&&m?z+=(z<1)/99:0)y=(1-z)*h[X++]/2||0,Y[P]=(Y[P]||0)-y*I+y,q[P]=(q[P++]||0)+y*I+y;c&&(z=c%1,I=d[1]||0,(c|=0)&&(h=F[[v=d[X=0]||0,c]]=F[[v,c]]||(u=[...l[v]],u[2]*=2**((c-12)/12),c>0?a(...u):[])))}p=k});return[Y,q]}]};app.width=360;app.height=740;var r=app.getContext("2d");r.imageSmoothingEnabled=!1;var re=app.getBoundingClientRect(),de="117, 252, 253";var fe="234, 59, 247",le="#0f0027",ue=60,[Ee,xe]=ae(ue),ne=44*(125/ue)/8.47,L={v:.5,r:44100,x:new AudioContext},Pe={v:.5,r:44100,x:new AudioContext};L.x.suspend();var[Ge,Se,ve]=K(L),[R]=K(Pe),Ie=ve(...Ee),se,Q=(e,t,a,l=24,n="white")=>{r.font=l+"px monospace",r.fillStyle=n,r.fillText(e,t,a)},T=(e=0,t=0)=>({x:e,y:t}),Le=(e,t)=>{e.x=t.x,e.y=t.y};var Te=(e,t)=>{let a=e.x-t.x,l=e.y-t.y;return Math.sqrt(a*a+l*l)},ze=(e,t,a)=>e.x>=t.x&&e.x<=a.x&&e.y>=t.y&&e.y<=a.y,g=!1,H=T(),$=(e,t)=>{let a=app.height/self.innerHeight;H.x=(e-re.x)*a,H.y=(t-re.y)*a};app.addEventListener("mousedown",e=>{$(e.clientX,e.clientY),g=e.button==0?!0:g});app.addEventListener("touchstart",e=>{$(e.touches[0].clientX,e.touches[0].clientY),g=!0});app.addEventListener("mousemove",e=>{$(e.clientX,e.clientY)});app.addEventListener("touchmove",e=>{$(e.touches[0].clientX,e.touches[0].clientY)});app.addEventListener("mouseup",e=>{g=e.button==0?!1:g});app.addEventListener("touchend",e=>{g=e.touches.length==0?!1:g});app.addEventListener("contextmenu",e=>{e.preventDefault()});var me=!1,be=!1,we=!1,ye=!1,Z=!1;self.addEventListener("keydown",e=>{switch(e.key){case"ArrowUp":case"w":{me=!0;break}case"ArrowLeft":case"a":{be=!0;break}case"ArrowDown":case"s":{we=!0;break}case"ArrowRight":case"d":{ye=!0;break}case"Enter":case" ":{Z=!0;break}}});self.addEventListener("keyup",e=>{switch(e.key){case"ArrowUp":case"w":{me=!1;break}case"ArrowLeft":case"a":{be=!1;break}case"ArrowDown":case"s":{we=!1;break}case"ArrowRight":case"d":{ye=!1;break}case"Enter":case" ":{Z=!1;break}}});var Be=(e,t)=>[...Array(e)].map(t),U=0,N=Be(16,()=>({age:0,pos:T()})),De=()=>{if(g){let e=N[U];e.age<1&&(e.age=1,Le(e.pos,H)),++U>=N.length&&(U=0)}else U=0;r.fillStyle="white";for(let e of N)e.age>0&&(r.beginPath(),r.arc(e.pos.x,e.pos.y,8/e.age,0,2*Math.PI),r.fill(),++e.age>8&&(e.age=0))},E=new Image;E.src="bastet.png";var V=(e,t,a,l)=>{r.drawImage(E,e*16,t*16,16,16,a,l,120,120)},W=(e,t,a)=>{let l=n=>n*Math.PI/180;switch(e){case 0:{r.translate(-25,-25);break}case 1:{r.translate(t,a),r.rotate(l(90)),r.translate(-t-25,-a-25);break}case 2:{r.translate(t,a),r.rotate(l(180)),r.translate(-t-25,-a-25);break}case 3:{r.translate(t,a),r.rotate(l(270)),r.translate(-t-25,-a-25);break}}r.drawImage(E,36,4,8,8,t,a,50,50),r.setTransform(1,0,0,1,0,0),r.translate(-40,-40),r.drawImage(E,16,0,16,16,t,a,80,80),r.setTransform(1,0,0,1,0,0)},ie=(e,t,a)=>{r.drawImage(E,16,0,8,16,e.x,e.y,40,80),r.drawImage(E,24,0,8,16,e.x+t-40,e.y,40,80),r.drawImage(E,22,0,4,3,e.x+40,e.y,t-80,15),r.drawImage(E,22,13,4,3,e.x+40,e.y+65,t-80,15),r.textAlign="center",r.textBaseline="middle",Q(a,e.x+t/2,e.y+40,29),r.textAlign="start",r.textBaseline="alphabetic"},Me=[{min:T(0,32),max:T(app.width,112)},{min:T(0,112),max:T(app.width,192)}],Re=()=>{r.globalAlpha=.2,Me.forEach((e,t)=>{let a=t!=0,l=`rgb(${a?de:fe})`,n=r.createLinearGradient(e.max.x/2,e.min.y,e.max.x/2,e.max.y);n.addColorStop(0,le),n.addColorStop(.5,l),n.addColorStop(1,le),r.fillStyle=n,r.fillRect(e.min.x,e.min.y,e.max.x,e.max.y-(32+t*80));let i=app.width/2+40,o=e.min.y+40;W(a?0:1,i-80,o),W(a?2:3,i,o)}),r.globalAlpha=1,V(0,0,-8,50),r.scale(-1,1),V(0,0,-app.width-8,50),r.scale(1,1),r.setTransform(1,0,0,1,0,0)},ke=40,ee=xe.reduce((e,t,a)=>(t.forEach((l,n)=>{l&&e.push({col:l,pos:T(n*80+140,a*80-(l-1)*80+192)})}),e),[]),oe=ee.map(()=>!1),j=0,pe=0,he=0,ce=(e,t)=>e.pos.y+ke<t,te=0,Ce=[()=>{ie({x:64,y:app.height/2-40},app.width-128,"Start!"),(g||Z)&&(L.x.resume(),R(.2,void 0,61,.1,void 0,.04,3,.4,void 0,void 0,150,.07,.01,void 0,void 0,void 0,.12,.67),se=Se(...Ie),se.loop=!0,te=1)},()=>{let e=L.x.currentTime;he=e-pe,pe=e;for(let t in ee){let a=ee[t];a.pos.y-=he*(80*xe.length/ne);let l=0;l|=a.pos.x>app.width/2?2:0,l|=a.col>1?1:0,Me.forEach((n,i)=>{if(g&&Te(H,a.pos)<=ke&&ze(a.pos,n.min,n.max)){if(i+1===a.col)j--,R(.3,0,164.81,.02,.2,void 0,3,void 0,void 0,void 0,10,.1,void 0,void 0,-1,void 0,.05,.3,.1);else switch(j+=2,l){case 0:{R(.2,0,415.3,.02,.2,void 0,3,void 0,void 0,void 0,10,.1,void 0,void 0,-1,void 0,.05,.3,.1);break}case 1:{R(.2,0,277.18,.02,.2,void 0,3,void 0,void 0,void 0,10,.1,void 0,void 0,-1,void 0,.05,.3,.1);break}case 2:{R(.2,0,466.16,.02,.2,void 0,3,void 0,void 0,void 0,10,.1,void 0,void 0,-1,void 0,.05,.3,.1);break}case 3:{R(.2,0,329.63,.02,.2,void 0,3,void 0,void 0,void 0,10,.1,void 0,void 0,-1,void 0,.05,.3,.1);break}}a.pos.y-=app.height}}),ce(a,32)&&!oe[t]&&(oe[t]=!0,j--),ce(a,app.height-80)&&(r.fillStyle=`rgba(${a.col%2?de:fe}, .4)`,r.beginPath(),r.arc(a.pos.x,a.pos.y,39,0,2*Math.PI),r.fill(),r.globalAlpha=.8,W(l,a.pos.x,a.pos.y),r.globalAlpha=1)}L.x.currentTime>ne&&(g=!1,te=2)},()=>{L.x.suspend(),ie({x:64,y:app.height/2-40},app.width-128,"try again"),(g||Z)&&location.reload()}],ge=1e3/60,_=0,O=performance.now();(function e(t){_=t-O,_>ge&&(r.clearRect(0,0,app.width,app.height),Ce[te](),Re(),V(1,1,app.width/2-64,app.height-120-16),De(),Q("Score: "+j,12,20,16),Q("Time: "+L.x.currentTime.toFixed(2),260,20,16),O=t-_%ge),requestAnimationFrame(e)})(O);
